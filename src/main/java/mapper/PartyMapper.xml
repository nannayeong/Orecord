<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="impl.PartyImpl">
	
	<!-- 협업신청목록 -->
	<select id="partyList" resultType="model.PartyBoardDTO">
		SELECT * FROM partyboard
			WHERE audio_idx=#{audio_idx}
		ORDER BY party_idx DESC
	</select>
	
	<!-- 협업신청폼 -->
	<select id="partyWrite" resultType="model.AudioBoardDTO">
		SELECT * FROM audioboard where audio_idx=#{audio_idx}
	</select>
	
	<!-- 협업신청처리 -->
	<insert id="partyAction">
		INSERT INTO partyboard
		(party_idx,id,audio_idx,title,contents,audiofilename,audiocontents,kind,point,exdate,regidate)
		VALUES
		(seq_partyboard.nextval, #{id}, #{audio_idx}, #{title}, #{contents},
			#{audiofilename},#{audiocontents}, #{kind}, #{point}, sysdate+7, sysdate)
	</insert>
	
	<!-- 협업신청처리(오디오파일X) -->
	<insert id="partyAction2">
		INSERT INTO partyboard
		(party_idx,id,audio_idx,title,contents,audiocontents,kind,point,exdate,regidate)
		VALUES
		(seq_partyboard.nextval, #{id}, #{audio_idx}, #{title}, #{contents},
			#{audiocontents}, #{kind}, #{point}, sysdate+7, sysdate)
	</insert>
	
	<!-- 협업신청서상세 -->
	<select id="partyView" resultType="model.PartyBoardDTO">
		SELECT * FROM partyboard WHERE party_idx=#{party_idx} AND id=#{id}
	</select>
</mapper>
